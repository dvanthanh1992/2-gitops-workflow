repositories:
  - name: jetstack
    url: https://charts.jetstack.io

releases:
  - name: cert-manager
    namespace: cert-manager
    createNamespace: true
    chart: jetstack/cert-manager
    version: "1.16.1"
    set:
      - name: installCRDs
        value: true
    hooks:
      - events: ["postsync"]
        showlogs: true
        command: "/bin/sh"
        args: 
          - "-c"
          - |
            kubectl wait \
              --for=condition=Ready \
              --timeout=600s \
              -n cert-manager \
              pod -l app=cert-manager && \
            hook/cert-manager.sh
